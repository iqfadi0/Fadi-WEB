<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Customer Management</title>
<style>
  body {
    background-color: #121212;
    color: #eee;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 0; padding: 20px;
  }
  h1 {
    color: #00d8ff;
    margin-bottom: 20px;
    text-align: center;
  }
  table {
    width: 100%;
    max-width: 700px;
    margin: auto;
    border-collapse: collapse;
  }
  th, td {
    border: 1px solid #00aaff;
    padding: 10px;
    text-align: center;
  }
  th {
    background-color: #00aaff;
    color: #121212;
  }
  tr:nth-child(even) {
    background-color: #1e1e1e;
  }
  .btn {
    background-color: #00aaff;
    color: #121212;
    border: none;
    padding: 8px 12px;
    cursor: pointer;
    border-radius: 5px;
    font-weight: 600;
  }
  .btn:hover {
    background-color: #008fcc;
  }
  .btn-danger {
    background-color: #ff5555;
    color: white;
  }
  .btn-danger:hover {
    background-color: #cc4444;
  }
  .top-buttons {
    max-width: 700px;
    margin: 20px auto;
    text-align: center;
  }
  a.button-link {
    text-decoration: none;
    margin: 0 10px;
  }
</style>
</head>
<body>
  <h1>قائمة المشتركين</h1>

  <div class="top-buttons">
    <a href="{{ url_for('add_customer') }}" class="button-link">
      <button class="btn">➕ إضافة مشترك جديد</button>
    </a>
  </div>

  {% if customers %}
  <table>
    <thead>
      <tr>
        <th>الاسم</th>
        <th>تاريخ الاشتراك</th>
        <th>حالة الدفع</th>
        <th>الإجراءات</th>
      </tr>
    </thead>
    <tbody>
      {% for name, info in customers.items() %}
      <tr>
        <td>{{ name }}</td>
        <td>{{ info.join_date }}</td>
        <td>
          {% if info.paid %}
            ✅ مدفوع
          {% else %}
            ❌ غير مدفوع
          {% endif %}
        </td>
        <td>
          {% if not info.paid %}
          <form style="display:inline;" method="post" action="{{ url_for('confirm_payment', name=name) }}">
            <button class="btn" type="submit">تأكيد الدفع</button>
          </form>
          {% endif %}
          <form style="display:inline;" method="post" action="{{ url_for('delete_customer', name=name) }}" onsubmit="return confirm('هل أنت متأكد من حذف هذا المشترك؟');">
            <button class="btn btn-danger" type="submit">حذف</button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
  <p style="text-align:center; margin-top: 50px;">لا يوجد مشتركين حالياً.</p>
  {% endif %}
</body>
</html>
